<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CineBook | Login or Register</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <style>
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .auth-container {
      background: #fff;
      width: 380px;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      position: relative;
      text-align: center;
      transition: all 0.4s ease;
    }

    .auth-container:hover {
      transform: translateY(-5px);
    }

    h2 {
      color: #5b5fc7;
      font-size: 2em;
      font-weight: 700;
      margin-bottom: 25px;
    }

    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }

    label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 10px;
      font-size: 15px;
      transition: all 0.3s;
    }

    input:focus {
      border-color: #667eea;
      outline: none;
      box-shadow: 0 0 6px rgba(102, 126, 234, 0.4);
    }

    .btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 10px;
      color: #fff;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      margin-top: 10px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }

    .toggle {
      margin-top: 15px;
      color: #667eea;
      font-weight: 600;
      cursor: pointer;
      transition: color 0.3s;
    }

    .toggle:hover {
      color: #764ba2;
    }

    .message {
      display: none;
      margin-top: 15px;
      padding: 10px;
      border-radius: 8px;
      font-weight: 500;
      font-size: 14px;
    }

    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    /* Subtle CineBook branding footer */
    .brand-footer {
      position: absolute;
      bottom: 10px;
      left: 0;
      right: 0;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.7);
      text-align: center;
      font-weight: 500;
      letter-spacing: 0.5px;
    }

    @media screen and (max-width: 480px) {
      .auth-container {
        width: 90%;
        padding: 30px;
      }
      h2 {
        font-size: 1.6em;
      }
    }
  </style>
</head>
<body>
  <div class="auth-container">
    <h2 id="formTitle">üé¨ CineBook Login</h2>

    <div class="form-group">
      <label for="username">Username</label>
      <input type="text" id="username" placeholder="Enter your username">
    </div>

    <div class="form-group">
      <label for="password">Password</label>
      <input type="password" id="password" placeholder="Enter your password">
    </div>

    <button class="btn" id="loginBtn" onclick="login()">Login</button>
    <button class="btn" id="registerBtn" onclick="registerUser()" style="display:none;">Register</button>

    <div class="toggle" id="toggleText" onclick="toggleMode()">New user? Register here</div>
    <div id="loginMessage" class="message"></div>
  </div>

  <div class="brand-footer">
    ¬© 2025 CineBook ‚Äî Crafted with ‚ù§Ô∏è for movie lovers
  </div>

  <script>
    let isRegisterMode = false;

    function toggleMode() {
      isRegisterMode = !isRegisterMode;
      document.getElementById('formTitle').textContent = isRegisterMode ? 'üé¨ Create Your CineBook Account' : 'üé¨ CineBook Login';
      document.getElementById('loginBtn').style.display = isRegisterMode ? 'none' : 'block';
      document.getElementById('registerBtn').style.display = isRegisterMode ? 'block' : 'none';
      document.getElementById('toggleText').textContent = isRegisterMode ? 'Already have an account? Login here' : 'New user? Register here';
      document.getElementById('loginMessage').style.display = 'none';
    }

    function login() {
      fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: document.getElementById('username').value.trim(),
          password: document.getElementById('password').value.trim()
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.redirect) {
          window.location.href = data.redirect;
        } else {
          showMessage(data.error || 'Login failed', 'error');
        }
      });
    }

    function registerUser() {
      fetch('/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: document.getElementById('username').value.trim(),
          password: document.getElementById('password').value.trim()
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.message) {
          showMessage(data.message, 'success');
          setTimeout(toggleMode, 1500);
        } else {
          showMessage(data.error || 'Registration failed', 'error');
        }
      });
    }

    function showMessage(msg, type) {
      const msgEl = document.getElementById('loginMessage');
      msgEl.textContent = msg;
      msgEl.className = 'message ' + type;
      msgEl.style.display = 'block';
    }
  </script>
</body>
</html>
